---
title: Reports Generator Script
weight: 30
geekdocCollapseSection: false
---

{{< toc >}}

## Overview

The Reports Generator script serves as the final step in a Well-Architected Reliability Assessment (WARA) engagement. It takes the Excel spreadsheet generated by the Data Analyzer script and converts it into Microsoft Word and PowerPoint formats. The Reports Generator automates the process of creating comprehensive reports from the analyzed data, making it easier to share insights and recommendations.

## Requirements

- [PowerShell 7](https://learn.microsoft.com/en-us/powershell/scripting/install/installing-powershell?view=powershell-7.4)
- Microsoft Excel, Word and PowerPoint installed
- Role Based Access Control: Reader role to access to resources to be evaluated. Although access to the Azure Subscriptions is not required to run the script, the access will be required for the user to complete some manual validations of configurations of Azure resources after the script generates the Excel file.

## Quick Start (Local Machine only - Cloud Shell is not supported)

- Download and run the reports generator script by copying and modifying this script block
- Once the script is downloaded you can execute it by running ./3_wara_reports_generator.ps1

```powershell
#Create new "WARA" directory under C:\ and navigate to C:\WARA. If not Windows then do nothing and move on.
$iswindows ? $(mkdir C:\WARA -ErrorAction SilentlyContinue;cd C:\WARA) : (Write-Host "C:\WARA - Not Required")

#Download the latest version of the script
invoke-webrequest https://aka.ms/aprl/tools/3 -out 3_wara_reports_generator.ps1

#Remove file blocking if active and running windows
$iswindows ? (unblock-file ./3_wara_reports_generator.ps1) : (Write-host "Unblock not required - Not Windows OS")

#Modify these parameters and run the script
.\3_wara_reports_generator.ps1 -CustomerName 'Contoso' -WorkloadName 'E-Commerce' -ExcelFile '.\WARA Action Plan 2024-08-08-11-57.xlsx'
```

## How to download

- [GitHub Link to Download](https://github.com/Azure/Azure-Proactive-Resiliency-Library-v2/blob/main/tools/3_wara_reports_generator.ps1)
- Download the script using command-line

    ```shell
    iwr https://aka.ms/aprl/tools/3 -out 3_wara_reports_generator.ps1
    ```

- Download the PowerPoint template using command-line

    ```shell
    iwr https://aka.ms/aprl/tools/pptx -out 'Mandatory - Executive Summary presentation - Template.pptx'
    ```

- Download the Word template using command-line

    ```shell
    iwr https://aka.ms/aprl/tools/docx -out 'Optional - Assessment Report - Template.docx'
    ```

- [GitHub Link to Sample Output - Executive Summary Presentation](https://github.com/Azure/Azure-Proactive-Resiliency-Library-v2/blob/main/tools/sample-output/Executive%20Summary%20Presentation%20-%20Contoso%20Hotels%20-%202024-05-07-12-12.pptx)
- [GitHub Link to Sample Output - Assessment Report](https://github.com/Azure/Azure-Proactive-Resiliency-Library-v2/blob/main/tools/sample-output/Assessment%20Report%20-%20Contoso%20Hotels%20-%202024-05-07-12-12.docx)

## How to run the script

{{< hint type=important >}}
  The Reports Generator script must be run from a Windows Machine with Excel, Word, and PowerPoint installed.
{{< /hint >}}

### Local Machine - Reports Generator

1. You will need to have both the Word and PowerPoint templates downloaded to the same file location.
  {{< figure src="../../img/tools/generator-1.png" width="80%" >}}

1. Change your directory to the same location that you have downloaded the WARA Reports Generator script to.

    - We recommend running this as close to your C:\ as path to avoid errors related to file path length.
    {{< figure src="../../img/tools/collector-7.png" width="40%" >}}

1. Execute script leveraging needed parameters
    - The script accepts both short and/or full paths.

    ```powershell
      .\3_wara_reports_generator.ps1 -CustomerName 'Contoso' -WorkloadName 'E-Commerce' -ExcelFile '.\WARA Action Plan 2024-08-08-11-57.xlsx'
    ```

    {{< figure src="../../img/tools/generator-2.png" width="100%" >}}

1. Select "R" to allow script to run
  {{< figure src="../../img/tools/generator-3.png" width="100%" >}}

1. After the script successfully runs, you will find two new files saved in your folder. Some of the information will be automatically populated based on the Action Plan.

  {{< hint type=important >}}
  Updates will need to be made prior to presenting to any audience.
  {{< /hint >}}

## PARAMETERS

### Help

Switch to display help information.

- **Required**: No
- **Position**: Named

### Debugging

Switch to enable debugging mode.

- **Required**: No
- **Position**: Named

### CustomerName

Name of the customer for whom the report is being generated.

- **Required**: No
- **Position**: Named

### WorkloadName

Name of the workload being assessed.

- **Required**: No
- **Position**: Named

### ExcelFile

Path to the Excel file created by the `2_wara_data_analyzer` script.

- **Required**: Yes
- **Position**: 0

### Heavy

Switch to enable heavy processing mode. When enabled, this mode introduces additional delays using Start-Sleep at various points in the script to handle heavy environments more gracefully. This can help in scenarios where the system resources are limited or the operations being performed are resource-intensive, ensuring the script doesn't overwhelm the system.

- **Required**: No
- **Position**: Named
- **Notes**: Use this parameter when your excel action plan has over 10,000 resources or is greater than 10MB. This will ensure your workstation is minimally impacted by the processing.

### PPTTemplateFile

Path to the PowerPoint template file.

- **Required**: No
- **Position**: Named

### WordTemplateFile

Path to the Word template file.

- **Required**: No
- **Position**: Named

## EXAMPLES

### Example 1

```powershell
.\3_wara_reports_generator.ps1 -ExcelFile '.\WARA Action Plan 2024-03-07-16-06.xlsx' -CustomerName 'ABC Customer' -WorkloadName 'SAP On Azure' -Heavy -PPTTemplateFile '.\Template.pptx' -WordTemplateFile '.\Template.docx'
```

## Frequently asked questions

### The specified Excel file may be encrypted. If a sensitivity label is applied to the file, please change the sensitivity label to the label without encryption temporarily

The specified Excel file may be has a sensitivity label (encrypted). The 3_wara_reports_generator.ps1 script does not support encrypted Excel file currently. To avoid this issue, you need to change the sensitivity label to the label without encryption temporarily. For example, **Confidential/Any User (No Protection)** sensitivity. After completing the script running, you can re-apply the original sensitivity label (recommended).

You can change the sensitivity label on the file by **Excel** or **Information Protection File Labeler**.

- Option 1: Excel

    1. Select a sensitivity label that you want from the sensitivity bar at the top of the Excel window.
    2. Save the Excel file.

    Learn more about the [Sensitivity bar in Microsoft 365](https://support.microsoft.com/office/2f96e7cd-d5a4-403b-8bd7-4cc636bae0f9).

- Option 2: Information Protection File Labeler

    1. Install the [Microsoft Purview Information Protection client](https://www.microsoft.com/en-us/download/details.aspx?id=53018)
    2. Right click the Excel file in the File Explorer then select **Show more options**.
    3. Select **Apply sensitivity label with Microsoft Purview**
    4. Select a sensitivity label that you want.
    5. Click the **Apply** button.

    Learn more about the [detailed usage of the Information Protection File Labeler](https://support.microsoft.com/topic/67829155-2d0e-4122-9677-7c53c8cba18a).
