---
title: Analyzer Cmdlet
weight: 20
geekdocCollapseSection: false
---

{{< toc >}}

## Overview

This Data Analyzer cmdlet is the second script used during Well-Architected Reliability Assessment (WARA) engagements. Based on the data generated by the Collector cmdlet, the Data Analyzer cmdlet collects the necessary information about recommendations from the Azure Proactive Resiliency Library (APRL) and generates an Action Plan Excel spreadsheet. The goal of this tool is to summarize the collected data and provide actionable insights into the health and resiliency of the Azure environment.

## Requirements

- [PowerShell 7.4](https://learn.microsoft.com/powershell/scripting/install/installing-powershell?view=powershell-7.4)
- [ImportExcel PowerShell Module](https://github.com/dfinke/ImportExcel)
  - If you do not have this module, then it is installed automatically when you run the `Start-WARAAnalyzer` cmdlet.
- Role Based Access Control: Reader role to access to resources to be evaluated. Although access to the Azure Subscriptions is not required to run the script, the access will be required for the user to complete some manual validations of configurations of Azure resources after the script generates the Excel file.

## Quick Start (Cloud Shell or Local Machine)

- The Analyzer cmdlet now supports PowerShell 7.4 and can be run on any platform that supports PowerShell. The following instructions have been tested on Azure Cloud Shell, Windows, and Linux.

{{< hint type=note >}}
When running the script on a Non-Windows environment you may see a warning message about ImportExcel Module Cannot Autosize. You can ignore this warning message.
{{< /hint >}}

```bash
Starting the WARA Analyzer
Validating ImportExcel Module..
Installing ImportExcel Module
Analysing Excel File Template
WARNING: ImportExcel Module Cannot Autosize. Please run the following command to install dependencies:
apt-get -y update && apt-get install -y --no-install-recommends libgdiplus libc6-dev
```

- The Start-WARAAnalyzer cmdlet is part of the WARA module. You can install the module from the PowerShell Gallery and import it to your PowerShell session.

```PowerShell
# Install the WARA module from the PowerShell Gallery.
Install-Module WARA
Import-Module WARA
```

### Start-WARAAnalyzer

The `Start-WARAAnalyzer` cmdlet is used to analyze the collected data and generate the core WARA Action Plan Excel file.

{{< hint type=note >}}
Whatever directory you run the `Start-WARAAnalyzer` cmdlet in, the Excel file will be created in that directory. For example: if you run the `Start-WARAAnalyzer` cmdlet in the `C:\Temp` directory, the Excel file will be created in the `C:\Temp` directory.
{{< /hint >}}

You can review all of the parameters of Start-WARAAnalyzer [here](https://github.com/Azure/Well-Architected-Reliability-Assessment/blob/main/docs/wara/Start-WARAAnalyzer.md).

#### Examples

#### Run the analyzer against a specific JSON file

```PowerShell
Start-WARAAnalyzer -JSONFile 'C:\WARA\WARA_File_2024-04-01_10_01.json'
```

## Expert Analysis Spreadsheet

Running the analyzer module will create the Expert-Analysis.xlsx file. You should now open this file and complete the steps below.

### 1. Workload Information sheet

Use this worksheet to enter information about the workload being assessed.

**Required Action:**

1. Ensure that all required fields are filled with the necessary information

### 2. Workload Inventory sheet

This sheet contains an inventory of Azure resources located within the defined scope used for the collector module. No action is required on this sheet, it is purely for informational purposes.

### 3. Analysis Planning sheet

This sheet summarizes recommendations and impacted resources by Azure resource type. This overview can be helpful in planning your assessment effort.

**Required Action:**

1. Ensure that all categories are fully validated and have a "Reviewed" status before running the Reports Generator script. The Assessment Status value for rows with a Category value of "Impacted Resources" will update dynamically as their associated rows in the Impacted Resources Analysis sheet are updated. The Assessment Status column value for rows with a Category value of "Support Requests" or "Platform Issues" are static and must be updated manually.

### 4. Impacted Resources Analysis sheet

This worksheet shows all in-scope impacted resources, that is, resources not following Microsoft recommendations for resiliency and reliability.

{{< hint type=note >}}
Always take into consideration customer and workload requirements when deciding if a recommendation is applicable.
{{< /hint >}}

**Required Actions:**

1. Review all impacted resources, remove any resources that are not part of the workload, or that are not associated with the environment you are reviewing. For example, if you are reviewing Production make sure DR and Shared Services are included, but remove resources from environments such as UAT, DEV, Test, Training, etc. When removing you can simply delete the row.
1. Review resources manually that are associated with a recommendation that does not have automated validation.
1. Review all resources and create personalized recommendation. This step is necessary for resource types or reliability configurations not covered by APRL or Advisor recommendations. Steps to add custom recommendations are detailed below.
1. Review all Well-Architected Framework recommendations.
1. Review all Azure Service Health - Service Retirements.
1. Enter any Architectural and/or Reliability Design Patterns recommendations identified during the assessment. This recommendation type is not required and will not be appropriate for all assessments.

#### General guidance

- For each of the above steps, for each resource/recommendation you should change the status to "Reviewed" or "Pending".
- Use "Reviewed" when the resource is **NOT compliant** with the recommendation and requires actions from the customer to remediate the issue.
- Use "Pending" when the recommendation requires further investigation or discussion with the workload owners.
- Use the "Notes" column to add any personalized notes.
- Delete the row if any resource is already compliant with the recommendation.
- Only add new columns at the end of **Table**, do not change the order of the columns or delete a column, as this can impact the generation of the final reports.

#### How to add a customized recommendation

- Scroll to the bottom of the table and start typing in the first empty cell after the last row to automatically add a new item in Excel Table.
- Populate all required blocks:
  - Analysis controls: REQUIRED ACTIONS / REVIEW STATUS, ValidationCategory, Resource Type;
  - Resource Information: name, id;
  - Recommendation Information: Recommendation Title, Impact (High, Medium or Low), Recommendation Control (use one of the existing categories), Potential Benefit, Learn More Link (Max 1 URL, URL only), Long Description.

### 5. Platform Issues sheet

This worksheet shows all Azure Platform and Service Issues that are associated with the resources used by the workload.

**Required Actions:**

1. Review the affected Azure Service, Date, Impact and Recommendations for each of Platform Issue.
1. For relevant Platform Issues (that really affected the workload), read the recommendations in field "What customers can do to avoid being affected", go to the Impacted Resources" worksheet, search for equivalent recommendations to associate with the Tracking ID of the Service Issue, or create a new recommendation(s) and associate with the necessary resource(s), or entire Subscription.
1. In the Impacted Resources Analysis sheet there is column called "Platform Issue TrackingId" that is used to associate a recommendation with a "Platform Issue Tracking ID".
1. Delete any issues from "Platform Issues" that you do not want to include in the final reports.

### 6. Support Requests sheet

This worksheet shows all Support Request Tickets opened by users for the Subscriptions associated with the workload.

**Required Actions:**

1. Review the resolution and recommendations from Microsoft Support for each of the Support Tickets. You should use the Azure Portal and/or CxObserve to complete this task.
1. For relevant Support Requests, using the recommendations from the Microsoft Support team, add the recommendations to the "Recommendations and Impacted Resources" and associate with the necessary resource(s), or entire workload (SubscriptionId).
1. In the Impacted Resources sheet there is column called "Support Request Number" that is used to associate a recommendation with a "Support Request".
1. Delete any irrelevant issues from "Support Requests" that you do not want to include in the final reports
